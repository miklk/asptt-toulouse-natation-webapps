<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="pragma" content="no-cache" />
    <META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">
    <title>ASPTT Grand Toulouse Natation - EN</title>
    <link rel="stylesheet" href="css/inscription.css" type="text/css" />
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/start/jquery-ui.css" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
    
    <style>
  #dialog label, #dialog input { display:block; }
  #dialog label { margin-top: 0.5em; }
  #dialog input, #dialog textarea { width: 95%; }
  </style>
  
  <script>
	function getCreneaux() {
		$.ajax({
            type: "POST",
            url: "testEcole.do?action=loadCreneaux",
            dataType: "json",
            success: function(data){
            	$("#formCreneau").empty();
            	$.each(data, function() {
            		var ligne = $("<p></p>");
            		$(ligne).append('<a href="testEcole.do?action=presence&selectedCreneau=' + this.id + '" >' + this.group.title + ' ' + this.swimmingPool + ' - ' + this.dayOfWeek + ' ' + this.beginStr + '-' + this.endStr +'</a>');
            		$("#formCreneau").append(ligne);
            	});
            }
        });
	}
	function getFiche(creneau) {
		$.ajax({type: "POST", data: $("#formCreneau").serialize(), url: "testEcole.do?action=export&selectedCreneau=" + creneau, dataType: "json",
			success: function(data) {
			},
			error:  function(jqXHR, textStatus, errorThrown) {
				if(jqXHR.responseText !== ''){
			        alert(jqXHR.responseText);
			    }else{
			        alert('Une erreur est survenue.');
			    }  
			}
		});
	}
	
	$(document).ready(function () {
		$( "#loading" ).dialog({
		      height: 140,
		      modal: true,
		      autoOpen: false,
		      dialogClass: 'loading-dialog'	
		    });
		$( document ).ajaxSend(function() {
			$("#loading").dialog("open");
		});
		$( document ).ajaxComplete(function() {
			$("#loading").dialog("close");
			});
		
		getCreneaux();
	  });
  </script>
  </head>

  <body>
  <div id="loading" title="Chargement en cours..." style="display:none">
  	<div style="text-align: center; color:#FFFFFF">
  		<img src="img/loader.gif" /><br />Chargement en cours...
  	</div>
  </div>
  <img src="img/logo.png" />
  <h2 style="float:right">Liste des adhérents par créneaux</h2>
  	<form id="formCreneau" method="POST" action="testEcole.do">
  	</form>
  </body>
</html>